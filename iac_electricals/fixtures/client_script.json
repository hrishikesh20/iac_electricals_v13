[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Receipt",
  "enabled": 1,
  "modified": "2021-11-16 17:41:12.617963",
  "name": "Purchase Receipt-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "// frappe.ui.form.on('Purchase Receipt', {\n// \trefresh(frm) {\n// \t\t// your code here\n// \t}\n// })\nfrappe.ui.form.on(\"Purchase Receipt Item\", \"qty_stock\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nif (d.stock_uom!=d.uom){    \nd.conversion_factor=d.qty_stock/d.qty;\nd.price_list_rate=d.rate_kg*(d.qty_stock/d.qty);\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\nd.amount=d.qty_stock*d.rate_kg;\nd.base_amount=d.qty_stock*d.rate_kg;\n}\nelse{\n d.conversion_factor=1;\n d.qty_stock=d.qty;\n d.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\nd.amount=d.qty_stock*d.rate_kg;\nd.base_amount=d.qty_stock*d.rate_kg;\n}\n});\nrefresh_field(\"items\");\n})\n// frappe.ui.form.on(\"Purchase Order\", \"validate\", function(frm, cdt, cdn) {\n// $.each(frm.doc.items || [], function(i, d) {\n// if (d.stock_uom!=d.uom){\n// d.conversion_factor=d.qty_stock/d.qty;\n// }\n// else{\n//  d.conversion_factor=1;\n//  d.qty_stock=d.qty;\n// }\n// });\n// refresh_field(\"items\");\n// })\n\nfrappe.ui.form.on(\"Purchase Receipt Item\", \"rate_kg\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nd.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\nd.amount=d.stock_qty*d.rate_kg;\nd.base_amount=d.qty_stock*d.rate_kg;\n});\nrefresh_field(\"items\");\n})\nfrappe.ui.form.on(\"Purchase Receipt Item\", \"conversion_factor\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nd.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\nd.qty_stock=d.qty*d.conversion_factor;\nd.amount=d.stock_qty*d.rate_kg;\nd.base_amount=d.stock_qty*d.rate_kg;\n});\n//refresh_field(\"items\");\n})\nfrappe.ui.form.on(\"Purchase Receipt\", \"validate\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nif (d.stock_uom!=d.uom){\nd.conversion_factor=d.qty_stock/d.qty;\nd.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\n\n}\nelse{\n d.conversion_factor=1;\n d.qty_stock=d.qty;\n d.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\n\n}\n});    \n\n//});\nrefresh_field(\"items\");\n })",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Work Order",
  "enabled": 1,
  "modified": "2021-11-12 17:19:56.378098",
  "name": "Work Order-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "// frappe.ui.form.on('Work Order', {                          \n//     onload_post_render: function(frm){                      \n//         frm.remove_custom_button('Create Job Card')\n//         }\n//     }\n// );\nfrappe.ui.form.on('Work Order', {                          \n    refresh: function(frm){                      \n        frm.remove_custom_button('Create Job Card')\n        }\n    }\n);\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Invoice",
  "enabled": 1,
  "modified": "2021-11-16 17:45:20.003754",
  "name": "Purchase Invoice-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "// frappe.ui.form.on('Purchase Invoice', {\n// \trefresh(frm) {\n// \t\t// your code here\n// \t}\n// })\nfrappe.ui.form.on(\"Purchase Invoice Item\", \"qty_stock\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nif (d.stock_uom!=d.uom){    \nd.conversion_factor=d.qty_stock/d.qty;\nd.price_list_rate=d.rate_kg*(d.qty_stock/d.qty);\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\nd.amount=d.qty_stock*d.rate_kg;\nd.base_amount=d.qty_stock*d.rate_kg;\n}\nelse{\n d.conversion_factor=1;\n d.qty_stock=d.qty;\n d.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\nd.amount=d.qty_stock*d.rate_kg;\nd.base_amount=d.qty_stock*d.rate_kg;\n}\n});\nrefresh_field(\"items\");\n})\n// frappe.ui.form.on(\"Purchase Order\", \"validate\", function(frm, cdt, cdn) {\n// $.each(frm.doc.items || [], function(i, d) {\n// if (d.stock_uom!=d.uom){\n// d.conversion_factor=d.qty_stock/d.qty;\n// }\n// else{\n//  d.conversion_factor=1;\n//  d.qty_stock=d.qty;\n// }\n// });\n// refresh_field(\"items\");\n// })\n\nfrappe.ui.form.on(\"Purchase Invoice Item\", \"rate_kg\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nd.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\nd.amount=d.stock_qty*d.rate_kg;\nd.base_amount=d.qty_stock*d.rate_kg;\n});\nrefresh_field(\"items\");\n})\nfrappe.ui.form.on(\"Purchase Invoice Item\", \"conversion_factor\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nd.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\nd.qty_stock=d.qty*d.conversion_factor;\nd.amount=d.stock_qty*d.rate_kg;\nd.base_amount=d.stock_qty*d.rate_kg;\n});\n//refresh_field(\"items\");\n})\nfrappe.ui.form.on(\"Purchase Invoice\", \"validate\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nif (d.stock_uom!=d.uom){\nd.conversion_factor=d.qty_stock/d.qty;\nd.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\n\n}\nelse{\n d.conversion_factor=1;\n d.qty_stock=d.qty;\n d.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\n\n}\n});    \n\n//});\nrefresh_field(\"items\");\n })",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Supplier Quotation",
  "enabled": 1,
  "modified": "2021-11-16 17:30:02.505288",
  "name": "Supplier Quotation-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "// frappe.ui.form.on('Supplier Quotation', {\n// \trefresh(frm) {\n// \t\t// your code here\n// \t}\n// })\nfrappe.ui.form.on(\"Supplier Quotation Item\", \"qty_stock\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nif (d.stock_uom!=d.uom){    \nd.conversion_factor=d.qty_stock/d.qty;\nd.price_list_rate=d.rate_kg*(d.qty_stock/d.qty);\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\nd.amount=d.qty_stock*d.rate_kg;\nd.base_amount=d.qty_stock*d.rate_kg;\n}\nelse{\n d.conversion_factor=1;\n d.qty_stock=d.qty;\n d.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\nd.amount=d.qty_stock*d.rate_kg;\nd.base_amount=d.qty_stock*d.rate_kg;\n}\n});\nrefresh_field(\"items\");\n})\n// frappe.ui.form.on(\"Purchase Order\", \"validate\", function(frm, cdt, cdn) {\n// $.each(frm.doc.items || [], function(i, d) {\n// if (d.stock_uom!=d.uom){\n// d.conversion_factor=d.qty_stock/d.qty;\n// }\n// else{\n//  d.conversion_factor=1;\n//  d.qty_stock=d.qty;\n// }\n// });\n// refresh_field(\"items\");\n// })\n\nfrappe.ui.form.on(\"Supplier Quotation Item\", \"rate_kg\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nd.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\nd.amount=d.stock_qty*d.rate_kg;\nd.base_amount=d.qty_stock*d.rate_kg;\n});\nrefresh_field(\"items\");\n})\nfrappe.ui.form.on(\"Supplier Quotation Item\", \"conversion_factor\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nd.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\nd.qty_stock=d.qty*d.conversion_factor;\nd.amount=d.stock_qty*d.rate_kg;\nd.base_amount=d.stock_qty*d.rate_kg;\n});\n//refresh_field(\"items\");\n})\nfrappe.ui.form.on(\"Supplier Quotation\", \"validate\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nif (d.stock_uom!=d.uom){\nd.conversion_factor=d.qty_stock/d.qty;\nd.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\n\n}\nelse{\n d.conversion_factor=1;\n d.qty_stock=d.qty;\n d.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\n\n}\n});    \n\n//});\nrefresh_field(\"items\");\n })\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Stock Entry",
  "enabled": 1,
  "modified": "2021-11-16 18:39:47.144259",
  "name": "Stock Entry-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "// frappe.ui.form.on('Stock Entry', {\n// \trefresh(frm) {\n// \t\t// your code here\n// \t}\n// })\nfrappe.ui.form.on(\"Stock Entry Detail\", \"qty_stock\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nif (d.stock_uom!=d.uom){    \nd.conversion_factor=d.qty_stock/d.qty;\n//d.rate=d.rate_kg*d.conversion_factor;\nd.amount_kg=d.rate_kg*d.qty_stock;\n}\nelse{\n d.conversion_factor=1;\n d.qty_stock=d.qty;\n//d.rate=d.rate_kg*d.conversion_factor;\nd.amount_kg=d.rate_kg*d.qty_stock;\n}\n});\nrefresh_field(\"items\");\n});\nfrappe.ui.form.on(\"Stock Entry Detail\", \"conversion_factor\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\n//d.rate=d.rate_kg*d.conversion_factor;\nd.qty_stock=d.qty*d.conversion_factor;\nd.amount_kg=d.rate_kg*d.qty_stock;\n});\nrefresh_field(\"items\");\n})\nfrappe.ui.form.on(\"Stock Entry Detail\", \"rate_kg\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nd.amount_kg=d.rate_kg*d.qty_stock;\n});\n});\n// frappe.ui.form.on(\"Stock Entry Detail\", \"conversion_factor\", function(frm, cdt, cdn) {\n// $.each(frm.doc.items || [], function(i, d) {\n// d.amount_kg=d.rate_kg*d.qty_stock;\n// });\n// })\nfrappe.ui.form.on(\"Stock Entry\", \"validate\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nif (d.stock_uom!=d.uom){    \nd.conversion_factor=d.qty_stock/d.qty;\n//d.rate=d.rate_kg*d.conversion_factor;\nd.amount_kg=d.rate_kg*d.qty_stock;\n}\nelse{\n d.conversion_factor=1;\n d.qty_stock=d.qty;\n//d.rate=d.rate_kg*d.conversion_factor;\nd.amount_kg=d.rate_kg*d.qty_stock;\n}\n});    \n\n//});\nrefresh_field(\"items\");\n })\n\n// frappe.ui.form.on(\"Stock Entry\", \"validate\", function(frm, cdt, cdn) {\n// $.each(frm.doc.items || [], function(i, d) {\n// d.amount_kg=d.rate_kg*d.transfer_qty;\n// });\n//  })\n \n frappe.ui.form.on(\"Stock Entry\", {\n\tvalidate: function(frm, cdt, cdn) {\n\t\tvar d = locals[cdt][cdn];\n\t\tvar total = 0;\nfrappe.model.set_value(d.doctype, d.name, \"amount_kg\", d.amount_kg);        \nfrm.doc.items.forEach(function(d) { total += d.amount_kg; });\n        frm.set_value('total_value', total);\n\t}\n});\n\nfrappe.ui.form.on(\"Stock Entry\", \"validate\", function(frm) {\nvar tot=0;\nfor (var i =0; i < cur_frm.doc.taxes.length; i++){\ncur_frm.doc.taxes[i].tax_amount=cur_frm.doc.total_value*(cur_frm.doc.taxes[i].rate/100)\ntot+=cur_frm.doc.taxes[i].tax_amount;\n}\ncur_frm.doc.grand_total=cur_frm.doc.total_value+tot;\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Order",
  "enabled": 1,
  "modified": "2021-11-16 17:38:59.251679",
  "name": "Purchase Order-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on(\"Purchase Order Item\", \"qty_stock\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nif (d.stock_uom!=d.uom){    \nd.conversion_factor=d.qty_stock/d.qty;\nd.price_list_rate=d.rate_kg*(d.qty_stock/d.qty);\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\nd.amount=d.qty_stock*d.rate_kg;\nd.base_amount=d.qty_stock*d.rate_kg;\n}\nelse{\n d.conversion_factor=1;\n d.qty_stock=d.qty;\n d.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\nd.amount=d.qty_stock*d.rate_kg;\nd.base_amount=d.qty_stock*d.rate_kg;\n}\n});\nrefresh_field(\"items\");\n})\n// frappe.ui.form.on(\"Purchase Order\", \"validate\", function(frm, cdt, cdn) {\n// $.each(frm.doc.items || [], function(i, d) {\n// if (d.stock_uom!=d.uom){\n// d.conversion_factor=d.qty_stock/d.qty;\n// }\n// else{\n//  d.conversion_factor=1;\n//  d.qty_stock=d.qty;\n// }\n// });\n// refresh_field(\"items\");\n// })\n\nfrappe.ui.form.on(\"Purchase Order Item\", \"rate_kg\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nd.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\nd.amount=d.stock_qty*d.rate_kg;\nd.base_amount=d.qty_stock*d.rate_kg;\n});\nrefresh_field(\"items\");\n})\nfrappe.ui.form.on(\"Purchase Order Item\", \"conversion_factor\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nd.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\nd.qty_stock=d.qty*d.conversion_factor;\nd.amount=d.stock_qty*d.rate_kg;\nd.base_amount=d.stock_qty*d.rate_kg;\n});\n//refresh_field(\"items\");\n})\nfrappe.ui.form.on(\"Purchase Order\", \"validate\", function(frm, cdt, cdn) {\n$.each(frm.doc.items || [], function(i, d) {\nif (d.stock_uom!=d.uom){\nd.conversion_factor=d.qty_stock/d.qty;\nd.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\n\n}\nelse{\n d.conversion_factor=1;\n d.qty_stock=d.qty;\n d.price_list_rate=d.rate_kg*d.conversion_factor;\nd.discount_percentage=0;\nd.discount_amount=0;\nd.rate=d.rate_kg*d.conversion_factor;\n\n}\n});    \n\n//});\nrefresh_field(\"items\");\n })\n//  frappe.ui.form.on(\"Purchase Order\", \"validate\", function(frm, cdt, cdn) {\n// $.each(frm.doc.items || [], function(i, d) {\n// if (d.stock_uom!=d.uom){\n// d.qty_stock=d.qty_stock;\n// }\n// });\n// })\n// frappe.ui.form.on(\"Purchase Order\", \"validate\", function(frm, cdt, cdn) {\n// $.each(frm.doc.items || [], function(i, d) {\n// d.rate=(d.rate_kg*d.conversion_factor*d.stock_qty);\n// });\n// })",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Quotation",
  "enabled": 1,
  "modified": "2021-06-11 15:59:23.647856",
  "name": "Quotation-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Quotation', {\n\tvalidate(frm) {\n        var total = 0;\n        $.each(frm.doc.items || [], function (i, d) {\n        console.log(\"Freight:\", d.unit_freight);\n        if (d.unit_freight) {\n            total = total + (d.qty * d.unit_freight);\n        }\n        total = total.toFixed(2); // Set recurring decimal limit\n        console.log(\"Total Value\", total);\n        });\n        var charges = frm.add_child(\"taxes\");\n        frappe.model.set_value(charges.doctype,charges.name,\"charge_type\",\"Actual\");\n        frappe.model.set_value(charges.doctype,charges.name,\"account_head\",\"Freight and Forwarding Charges - IEPL\");\n        frappe.model.set_value(charges.doctype,charges.name,\"description\",\"Unit Freight Computed\");\n        frappe.model.set_value(charges.doctype,charges.name,\"tax_amount\",total);\n        cur_frm.refresh_field(\"taxes\");\n    }\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Blanket Order",
  "enabled": 0,
  "modified": "2021-12-10 09:53:50.888034",
  "name": "Blanket Order-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Blanket Order', {\n\trefresh(frm) {\n\t\trefresh_field(\"items\");\n\t},\n\thiring_order:function(frm) {\n\t   if (frm.doc.hiring_order) {\n\t\tfrappe.call({\n\t\t\tmethod: \"iac_electricals.iac_electricals.custom_scripts.blanket_order.blanket_order.get_item\",\n\t\t\targs: {\"price_schedule_\":frm.doc.price_schedule_},\n\t\t\tcallback: function(r) {console.log('r',r.message[0],'r');\n\t\t\t\tif (r.message){ console.log('Add Row in Items');\n\t\t\t\tvar a = cur_frm.add_child(\"items\");    \n\t\t\t\ta.item_code = r.message[0];\n\t\t\t\ta.item_name = r.message[1];\n\t\t\t\ta.qty = r.message[2];\n\t\t\t\ta.rate = r.message[3];\n\n\t\t\t\t}\n\t\t\tcur_frm.refresh_fields(\"items\");\t\n\t\t},\n\t});\n\n\t   \n\t\t   \n\t   \n\t\t\n\t} \n\t\n\t\n }\n \n})",
  "view": "Form"
 }
]